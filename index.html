<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ¯ ØªØ­Ø¯ÙŠØ§Øª Red Dead Online Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0e0f12; --card:#15171b; --muted:#9aa3b2;
      --text:#e9edf3; --accent:#22d3ee; --line:#2a2f39;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:radial-gradient(1200px 800px at 80% -20%, #1b1f28 0%, #0e0f12 55%) fixed;
      color:var(--text);
      font-family:"Tajawal",sans-serif;
      line-height:1.7;
      padding:0 16px 80px;
      -webkit-user-select:none; /* ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ ÙÙŠ CSS */
      -moz-user-select:none;
      -ms-user-select:none;
      user-select:none;
    }
    .wrap{max-width:980px;margin:auto;}
    .topbar{
      background:#15171b;border-bottom:1px solid var(--line);
      padding:12px 18px;text-align:center;font-weight:700;
      font-size:20px;color:var(--accent);
      box-shadow:0 4px 20px rgba(0,0,0,.3);
      position:sticky;top:0;z-index:1000;
    }
    header{
      background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));
      border:1px solid var(--line);
      border-radius:20px;
      padding:20px;margin-top:20px;margin-bottom:18px;
      box-shadow:0 8px 24px rgba(0,0,0,.35),inset 0 1px 0 rgba(255,255,255,.04);
      text-align:center;
    }
    h1{margin:0;font-weight:800;font-size:26px}
    .card{background:var(--card);border:1px solid var(--line);
      border-radius:18px;padding:16px;margin-top:14px}
    h2{margin-top:0;color:var(--accent);font-size:18px}
    ul{margin:0;padding:0;list-style:none}
    li{border-top:1px dashed var(--line);padding:8px 4px}
    li:first-child{border-top:none}
    footer{text-align:center;margin-top:24px;color:var(--muted);font-size:13px}
    .join-btn{
      display:inline-block;background:var(--accent);color:#000;text-decoration:none;
      font-weight:700;padding:10px 20px;border-radius:12px;margin-top:10px;
    }

    /* ØªØ­Ø°ÙŠØ± Ù…Ø±Ø¦ÙŠ Ø¹Ù†Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø© Ø­ÙØ¸ Ø§Ù„ØµÙØ­Ø© */
    #protectToast{
      position:fixed;left:50%;transform:translateX(-50%);bottom:18px;
      background:#111;padding:10px 14px;border-radius:12px;color:var(--text);
      box-shadow:0 6px 20px rgba(0,0,0,.6);display:none;font-weight:700;
    }
    /* Ø§Ø¬Ø¹Ù„ canvas ÙŠØ³ØªØ¬ÙŠØ¨ */
    #canvasHolder{margin-top:14px;display:flex;justify-content:center;}
    canvas{max-width:100%;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.35);}
  </style>
</head>
<body>
  <div class="topbar" id="topdate">ğŸ“… Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«...</div>

  <div class="wrap">
    <header>
      <h1>ğŸ¯ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h1>
    </header>

    <div id="canvasHolder">
      <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ canvas Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù‡Ù†Ø§ -->
      <div id="challenges">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª...</div>
    </div>

    <footer>
      <p><b>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ù‚Ø±ÙˆØ¨ RDD_TOP@ 'Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø¹Ø³ÙŠØ±ÙŠ'</b></p>
      <a class="join-btn" href="https://t.me/RDD_TOP" target="_blank">ğŸ”— Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø±ÙˆØ¨</a>
    </footer>
  </div>

  <div id="protectToast">ğŸ”’ ØªÙ… ØªØ¹Ø·ÙŠÙ„ Ù†Ø³Ø® Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ‚</div>

  <script>
  /******************************
   Ø§Ù„Ø­Ù…Ø§ÙŠØ©: ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø± Ø¨Ø§Ù„Ø²Ø± Ø§Ù„Ø£ÙŠÙ…Ù†ØŒ Ø§Ù„Ù†Ø³Ø®ØŒ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ØµØŒ ÙˆØ§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ù…ÙØ§ØªÙŠØ­
  *******************************/
  document.addEventListener('contextmenu', e => { e.preventDefault(); showToast(); });
  document.addEventListener('selectstart', e => e.preventDefault());
  document.addEventListener('copy', e => { e.preventDefault(); showToast(); });
  document.addEventListener('cut', e => { e.preventDefault(); showToast(); });

  document.addEventListener('keydown', function(e){
    // Ù…Ù†Ø¹ F12, Ctrl+Shift+I, Ctrl+U, Ctrl+S, Ctrl+Shift+C
    if (e.key === 'F12' ||
        (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'i') ||
        (e.ctrlKey && e.key.toLowerCase() === 'u') ||
        (e.ctrlKey && e.key.toLowerCase() === 's') ||
        (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'c')
       ) {
      e.preventDefault();
      showToast();
    }
  });

  let toastTimer = null;
  function showToast(){
    const t = document.getElementById('protectToast');
    t.style.display = 'block';
    if (toastTimer) clearTimeout(toastTimer);
    toastTimer = setTimeout(()=> t.style.display='none', 1600);
  }

  /******************************
   ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†ØµÙŠØŒ Ø«Ù… Ø±Ø³Ù… Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¹Ù„Ù‰ Canvas
  *******************************/
  function wrapText(ctx, text, maxWidth, rtl){
    // ÙŠÙØ¹ÙŠØ¯ Ù…ØµÙÙˆÙØ© Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ù…Ù„ØªÙØ©
    const words = text.split(' ');
    const lines = [];
    let line = '';
    for (let n = 0; n < words.length; n++) {
      const testLine = line ? (line + ' ' + words[n]) : words[n];
      const metrics = ctx.measureText(testLine);
      if (metrics.width > maxWidth && line) {
        lines.push(line);
        line = words[n];
      } else {
        line = testLine;
      }
    }
    if (line) lines.push(line);
    // Ù„Ø¹Ø±Ø¨ÙŠØ© R-L Ù‚Ø¯ Ù†Ø­ØªØ§Ø¬ Ù„Ø¹ÙƒØ³ ØªØ±ØªÙŠØ¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø·Ø± Ù„Ø¹Ø±Ø¶ Ø£Ø­Ø³Ù† Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø­Ø§Ø°Ø§Ø© 'right'
    if (rtl) return lines.map(l => l.split(' ').reverse().join(' '));
    return lines;
  }

  function renderToCanvas(lines, dateStr){
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ØªØµÙ…ÙŠÙ…ÙŠØ©
    const padding = 22;
    const sectionGap = 18;
    const titleSize = 20;
    const itemSize = 16;
    const lineSpacing = 6;
    const canvasMaxWidth = Math.min(980, window.innerWidth - 40);

    // Ø£Ù†Ø´Ø¦ Ø¹Ù†ØµØ± canvas
    const canvas = document.createElement('canvas');
    canvas.width = Math.min(1200, canvasMaxWidth * 2); // Ù…Ø¶Ø§Ø¹Ù Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¯Ù‚Ø© Ø¹Ù„Ù‰ Ø´Ø§Ø´Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„ÙƒØ«Ø§ÙØ©
    const ctx = canvas.getContext('2d');
    // ØªØ¹ÙŠÙŠÙ† Ø®Ø·ÙˆØ· (Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‚Ø¯ ØªØ­ØªØ§Ø¬ Ø§Ù„Ù…ØªØµÙØ­ Ù„ØªØ­Ù…ÙŠÙ„ Ø®Ø· TajawalØŒ Ù†Ø³ØªØ®Ø¯Ù… fallback Ø¥Ø°Ø§ Ù„Ù… ÙŠÙØ­Ù…Ù‘Ù„)
    const scale = window.devicePixelRatio || 1;
    ctx.scale(scale, scale);
    const logicalWidth = canvas.width / scale;
    // Ø®Ø· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„Ù‚Ø³Ù…
    ctx.font = `${titleSize}px Tajawal, system-ui, sans-serif`;
    ctx.textAlign = 'right';
    ctx.textBaseline = 'top';

    // Ø­Ø³Ø§Ø¨ Ø§Ø±ØªÙØ§Ø¹ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
    let y = padding;
    // Ù†ÙƒØªØ¨ ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ù†ÙØ³ (Ù…ÙˆÙ‚Ø¹ Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†)
    ctx.font = `bold ${itemSize}px Tajawal, system-ui, sans-serif`;
    y += itemSize + 6;

    // Ù‚Ù… Ø¨Ø­Ø³Ø§Ø¨ ÙƒÙ„ Ø§Ù„Ø£Ø³Ø·Ø± Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ø±ØªÙØ§Ø¹ Ù†Ù‡Ø§Ø¦ÙŠ
    let totalHeight = y;
    const prepared = [];
    lines.forEach(line => {
      if (!line.trim()) return;
      // Ø§Ø¹ØªØ¨Ø§Ø± Ø£Ù† Ø³Ø·ÙˆØ± Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ù„Ø§ ØªØ¨Ø¯Ø£ Ø¨Ù€ "â–ª" Ø£Ùˆ Ø¨Ù€ "0" Ø£Ùˆ "$"
      if (!line.match(/^0|^\$|^â–ª|^-/)) {
        // Ø¹Ù†ÙˆØ§Ù† Ù‚Ø³Ù…: ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙ„ØªÙ
        ctx.font = `bold ${titleSize}px Tajawal, system-ui, sans-serif`;
        const titleLines = wrapText(ctx, line.trim(), logicalWidth - padding*2, true);
        prepared.push({type:'title', lines: titleLines});
        totalHeight += titleLines.length * (titleSize + lineSpacing) + sectionGap;
      } else {
        // Ø¹Ù†ØµØ± Ù‚Ø§Ø¦Ù…Ø©
        ctx.font = `${itemSize}px Tajawal, system-ui, sans-serif`;
        const itemText = line.replace(/^0|^\$|^â–ª|^-/, '').trim();
        const itemLines = wrapText(ctx, 'â–ªï¸ ' + itemText, logicalWidth - padding*2, true);
        prepared.push({type:'item', lines: itemLines});
        totalHeight += itemLines.length * (itemSize + lineSpacing);
      }
    });

    // Ø§Ø¶Ø¨Ø· Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ÙƒØ§Ù†ÙØ³ Ù…Ø¹ Ø§Ù„Ù‡Ø§Ù…Ø´
    canvas.height = Math.max(200, (totalHeight + padding*1.5) * scale);
    // Ø¥Ø¹Ø§Ø¯Ø© Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ø³ÙŠØ§Ù‚ Ø¨Ø¹Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø±ØªÙØ§Ø¹
    ctx.setTransform(scale,0,0,scale,0,0);
    // Ø®Ù„ÙÙŠØ© ÙˆØ§Ø·Ø§Ø±
    ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--bg') || '#0e0f12';
    ctx.fillRect(0,0,canvas.width/scale,canvas.height/scale);
    // Ø¸Ù„/Ø¥Ø·Ø§Ø±
    // Ø§Ù„Ø¢Ù† Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø±Ø³Ù… Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰
    y = padding;
    // Ø§ÙƒØªØ¨ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ù†ÙØ³ (ÙŠÙ…ÙŠÙ†)
    ctx.fillStyle = '#22d3ee';
    ctx.font = `700 ${itemSize}px Tajawal, system-ui, sans-serif`;
    ctx.textAlign = 'right';
    ctx.fillText('ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«: ' + dateStr, logicalWidth - padding, y);
    y += itemSize + 12;

    // Ø±Ø³Ù… ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø¹Ù†Ø§ØµØ±
    prepared.forEach(chunk => {
      if (chunk.type === 'title') {
        ctx.fillStyle = '#15171b'; // Ø®Ù„ÙÙŠØ© Ø¨Ø·Ø§Ù†Ø© ØµØºÙŠØ±Ø©
        // Ø±Ø³Ù… Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù‚Ø³Ù… Ø¨Ø®Ø· Ø£ÙƒØ¨Ø±
        ctx.font = `700 ${titleSize}px Tajawal, system-ui, sans-serif`;
        chunk.lines.forEach(ln=>{
          ctx.fillStyle = '#22d3ee';
          ctx.fillText(ln, logicalWidth - padding, y);
          y += titleSize + lineSpacing;
        });
        y += 6; // ÙØ±Ø§Øº Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
      } else { // item
        ctx.font = `${itemSize}px Tajawal, system-ui, sans-serif`;
        ctx.fillStyle = '#e9edf3';
        chunk.lines.forEach(ln=>{
          ctx.fillText(ln, logicalWidth - padding, y);
          y += itemSize + lineSpacing;
        });
      }
      // ÙØ±Ø§Øº Ø¨Ø¹Ø¯ Ø§Ù„Ù‚Ø³Ù…/Ø§Ù„Ø¨Ù†Ø¯
      y += 6;
    });

    // Ø¶Ø¨Ø· Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù„ÙƒØ§Ù†ÙØ³ (CSS)
    canvas.style.width = Math.min(980, window.innerWidth - 40) + 'px';
    canvas.style.height = ((canvas.height/scale)) + 'px';
    // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¹Ù†ØµØ±
    const holder = document.getElementById('canvasHolder');
    holder.innerHTML = '';
    holder.appendChild(canvas);
  }

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†ØµÙŠ ÙˆØ§Ù„ØªØ­Ø¶ÙŠØ±
  fetch("font-size.txt?" + Date.now())
    .then(r => {
      // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† 200ØŒ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø·Ø£ (Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ GitHub Pages ÙŠØ¹ÙŠØ¯ HTML Ù„ØµÙØ­Ø© 404)
      if (!r.ok) throw new Error('fetch failed: ' + r.status);
      return r.text();
    })
    .then(text=>{
      // Ø¥Ø²Ø§Ù„Ø© BOM Ø¥Ù† ÙˆØ¬Ø¯
      if (text.charCodeAt(0) === 0xFEFF) text = text.slice(1);
      const lines = text.split(/\r?\n/);
      const firstLine = (lines[0] || '').trim() || 'â€”';
      document.getElementById("topdate").innerHTML = `ğŸ“… <b>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«:</b> ${firstLine}`;
      lines.shift(); // Ø­Ø°Ù Ø§Ù„ØªØ§Ø±ÙŠØ®
      // Ù†Ø·Ù„Ø¨ Ù…Ù† Ù…ØªØµÙØ­ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø· Ù‚Ø¨Ù„ Ø§Ù„Ø±Ø³Ù… Ù„Ø¶Ù…Ø§Ù† ØªÙ†Ø§Ø³Ù‚ Ø§Ù„Ù†ØµÙˆØµ
      if (document.fonts && document.fonts.ready) {
        document.fonts.ready.then(()=> renderToCanvas(lines, firstLine)).catch(()=> renderToCanvas(lines, firstLine));
      } else {
        // fallback
        setTimeout(()=> renderToCanvas(lines, firstLine), 300);
      }
    })
    .catch(err=>{
      console.error(err);
      document.getElementById("challenges").innerHTML="âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª.";
      // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªÙØµÙŠÙ„ÙŠØ© ÙÙŠ topbar
      document.getElementById("topdate").innerText = "âš ï¸ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ font-size.txt â€” ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ù„Ù ÙˆÙ…Ø³Ø§Ø±Ù‡";
    });

  // Ù…Ù†Ø¹ Ø§Ù„Ø³Ø­Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© (touch) Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØµØ¹ÙˆØ¨Ø© Ø¹Ù„Ù‰ Ù…Ø­Ø§ÙˆÙ„Ø© Ù†Ø³Ø® Ø¹Ø¨Ø± Ø§Ù„Ù„Ù…Ø³
  window.addEventListener('touchstart', function(e){ if (e.touches.length > 1) e.preventDefault(); }, {passive:false});
  </script>
</body>
</html>
